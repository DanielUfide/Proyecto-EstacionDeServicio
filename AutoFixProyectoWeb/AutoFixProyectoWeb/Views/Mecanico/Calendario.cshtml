@{
    ViewBag.Title = "Calendario";
    Layout = "~/Views/Shared/_LayoutMenusMecanico.cshtml";
}
@section Styles{
    @*FullCalendar*@
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales-all.min.js'></script>
    <style>
        #calendar {
            max-width: 900px;
            margin: 0 auto;
        }
    </style>
}

<div class="main-content position-relative bg-gray-100 max-height-vh-100 h-100">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur"
         navbar-scroll="true">
        <div class="container-fluid py-1 px-3">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
                    <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="javascript:;">Menu</a></li>
                    <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Calendario</li>
                </ol>
                <h6 class="font-weight-bolder mb-0">Calendario</h6>
            </nav>
        </div>
    </nav>
    <!-- End Navbar -->

    <div class="container-fluid">


        <div id='calendar'></div>
    </div>

    <!-- Modal Events -->
    <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Event Details</h5>
                    <span id="date" class="font-weight-bold"></span>
                </div>
                <div class="modal-body">
                    <p>Cliente: <span id="client"></span> </p>
                    <p>Vehiculo: <span id="vehicle"></span> </p>
                    <p>Detalle del servicio: <span id="detail-service"></span> </p>
                </div>
                <div class="row mt-xl-3 justify-content-center text-center">
                    <div class="col-md-12">
                        <button class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </div>

            </div>
        </div>
    </div>


</div>
@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales-all.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                locale: 'es',
                events: '@Url.Action("GetEvents", "Mecanico")',
                eventClassNames: function (arg) {
                    return ['cursor-pointer'];
                },
                eventTimeFormat: { // formato de la hora
                    hour: '2-digit',
                    minute: '2-digit',
                    meridiem: false
                },
                eventClick: function (info) {
                    // Aquí va la lógica para abrir el modal
                    $('#myModal').modal('show'); // Suponiendo que estás usando Bootstrap para el modal
                    // También puedes pasar información del evento al modal
                    $('#myModal .modal-title').text(info.event.title);
                    //$('#myModal .modal-body').html('<p>' + info.event.start.toLocaleString() + '</p>');

                    let extraProps = info.event.extendedProps

                    console.log(extraProps)

                    $('#myModal .modal-header #date').text(info.event.start.toLocaleString());
                    $('#myModal .modal-body #client').text(extraProps.client);
                    $('#myModal .modal-body #vehicle').text(extraProps.vehicle);
                    $('#myModal .modal-body #detail-service').text(extraProps.description);

                }
            });
            calendar.render();
        });
    </script>
}